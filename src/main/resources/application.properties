# Server Configuration
server.port=${SERVER_PORT:8085}

# OpenAPI Configuration (Scalar UI)
springdoc.api-docs.path=/api-docs
springdoc.api-docs.enabled=true
springdoc.swagger-ui.enabled=false

# File Upload Configuration
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=200MB
spring.servlet.multipart.max-request-size=200MB

# Logging Configuration
logging.config=classpath:logback-spring.xml
logging.file.path=${LOG_PATH:./logs}
logging.level.root=${LOG_LEVEL:INFO}
logging.level.io.mersel.dss.signer.api=${LOG_LEVEL:INFO}

# Application Info
spring.application.name=mersel-dss-signer-api
info.app.name=Mersel DSS Signer API
info.app.description=Dijital Imza Servisi API
info.app.version=@project.version@

# CORS Configuration
# Production ortamında spesifik domain'ler kullanın
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:*}
cors.allowed-methods=${CORS_ALLOWED_METHODS:GET,POST,PUT,DELETE,OPTIONS}
cors.max-age=${CORS_MAX_AGE:3600}

# Actuator Configuration
management.endpoints.web.exposure.include=health,info,prometheus,metrics
management.health.defaults.enabled=true
management.info.env.enabled=true

# Prometheus Metrics Configuration
management.metrics.export.prometheus.enabled=true
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.tags.application=${spring.application.name}

# ============================================
# Keystore Configuration (Environment Variables)
# ============================================
# Aşağıdaki yapılandırmalar environment variable olarak verilmelidir.
# Örnek: export PKCS11_LIBRARY=/path/to/library.so

# --- PKCS#11 (HSM) Yapılandırması (Örnek) ---
# PKCS11_LIBRARY=/usr/local/lib/libakisp11.dylib
# PKCS11_SLOT=0
# CERTIFICATE_PIN=your-hsm-pin
# CERTIFICATE_SERIAL_NUMBER=your-serial-number

# --- PFX Dosyası Yapılandırması ---
# PFX_PATH=/path/to/certificate.pfx
# CERTIFICATE_PIN=your-password

# --- Sertifika Seçimi (İsteğe Bağlı) ---
# Keystore içinde birden fazla sertifika varsa seçim yapabilirsiniz:
#
# Yöntem 1: Alias ile seçim (önerilen, hızlı erişim)
#
# Yöntem 2: Serial number ile seçim (hexadecimal format)
#
# Not: 
# - Hem alias hem de serial number belirtilirse önce alias denenir
# - Hiçbiri belirtilmezse keystore'daki ilk uygun sertifika kullanılır
# - Serial number hex formatında olmalıdır (örn: 4E7B8A92D13F5C6A)
# - Detaylı bilgi: docs/CERTIFICATE_SELECTION.md

# --- Sertifika Zinciri Yapılandırması ---
# CERTIFICATE_CHAIN_GET_ONLINE=true
# ISSUER_CERTIFICATE_PATH=/path/to/issuer.cer
# CA_CERTIFICATE_PATH=/path/to/ca.cer

# --- Guvenilir Kok Sertifika Resolver Konfigurasyonu ---
# Resolver tipi: "kamusm-online", "kamusm-offline" veya "certificate-folder"
# - kamusm-online: Internet uzerinden KamuSM XML deposunu yukler
# - kamusm-offline: Yerel dosya sisteminden KamuSM XML deposunu yukler
# - certificate-folder: Belirtilen klasordeki tum .crt/.cer dosyalarini yukler
trusted.root.resolver.type=${TRUSTED_ROOT_RESOLVER_TYPE:kamusm-online}

# --- KamuSM XML Depo Online Resolver ---
# KamuSM XML deposu URL'i (online resolver icin)
kamusm.root.url=${KAMUSM_ROOT_URL:http://depo.kamusm.gov.tr/depo/SertifikaDeposu.xml}

# --- Otomatik Yenileme Cron ---
# Tum resolver'lar icin ortak otomatik yenileme cron ifadesi
# Offline ve folder resolver'larda da calisir ancak basarisiz olursa onceki sertifikalar korunur
trusted.root.refresh-cron=${TRUSTED_ROOT_REFRESH_CRON:0 15 3 * * *}

# --- KamuSM XML Depo Offline Resolver ---
# KamuSM XML dosya yolu (offline resolver icin)
# Ornek: file:/path/to/SertifikaDeposu.xml veya classpath:kamusm/SertifikaDeposu.xml
kamusm.root.offline.path=${KAMUSM_ROOT_OFFLINE_PATH:}

# --- Certificate Folder Resolver ---
# Sertifika klasoru yolu (certificate-folder resolver icin)
# Bu klasordeki tum .crt, .cer ve .pem dosyalari guvenilir kok sertifika olarak yuklenir
# Ornek: file:/path/to/certificates veya /absolute/path/to/certificates
trusted.root.cert.folder.path=${TRUSTED_ROOT_CERT_FOLDER_PATH:}

# --- Zaman Damgası (Timestamp) Yapılandırması (Örnek) ---
# TS_SERVER_HOST=http://zd.kamusm.gov.tr
# TS_USER_ID=your-user-id
# TS_USER_PASSWORD=your-password
# TS_DIGEST_ALGORITHM=SHA-256
# IS_TUBITAK_TSP=true

# --- TÜBİTAK ESYA Zaman Damgası ---
# MA3API_LICENSE_PATH=/path/to/license.dat

# --- Performans Yapılandırması ---
# MAX_SESSION_COUNT=5

# CERTSTORE_PATH=SertifikaDeposu.svt